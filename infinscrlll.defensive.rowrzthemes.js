(function(e){e.fn.infinitescroll=function(t,n){function r(){if(h.debug){window.console&&console.log.call(console,arguments)}}function i(t){for(var n in t){if(n.indexOf&&n.indexOf("Selector")>-1&&e(t[n]).length===0){r("Your "+n+" found no elements.");return false}return true}}function s(e){e.match(m)?e.match(m)[2]:e;if(e.match(/^(.*?)\b2\b(.*?$)/)){e=e.match(/^(.*?)\b2\b(.*?$)/).slice(1)}else if(e.match(/^(.*?)2(.*?$)/)){if(e.match(/^(.*?page=)2(\/.*|$)/)){e=e.match(/^(.*?page=)2(\/.*|$)/).slice(1);return e}r("Trying backup next selector parse technique. Treacherous waters here, matey.");e=e.match(/^(.*?)2(.*?$)/).slice(1)}else{if(e.match(/^(.*?page=)1(\/.*|$)/)){e=e.match(/^(.*?page=)1(\/.*|$)/).slice(1);return e}r("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com.");p.isInvalidPage=true}return e}function o(){return h.localMode?e(p.container)[0].scrollHeight&&e(p.container)[0].scrollHeight:e(document).height()}function u(){var t=0+o()-(h.localMode?e(p.container).scrollTop():e(p.container).scrollTop()||e(p.container.ownerDocument.body).scrollTop())-e(h.localMode?p.container:window).height();r("math:",t,p.pixelsFromNavToBottom);return t-h.bufferPx<p.pixelsFromNavToBottom}function a(){p.loadingMsg.find("img").hide().parent().find("div").html(h.donetext).animate({opacity:1},2e3).fadeOut("normal");h.errorCallback()}function f(){if(p.isDuringAjax||p.isInvalidPage||p.isDone)return;if(!u(h,p))return;e(document).trigger("retrieve.infscr")}function l(){p.isDuringAjax=true;p.loadingMsg.appendTo(h.contentSelector).show();e(h.navSelector).hide();p.currPage++;r("heading into ajax",g);d=e(h.contentSelector).is("table")?e("<tbody/>"):e("<div/>");v=document.createDocumentFragment();d.load(g.join(p.currPage)+" "+h.itemSelector,null,c)}function c(){if(p.isDone){a();return false}else{var t=d.children().get();if(t.length==0){return e.event.trigger("ajaxError",[{status:404}])}while(d[0].firstChild){v.appendChild(d[0].firstChild)}e(h.contentSelector)[0].appendChild(v);p.loadingMsg.fadeOut("normal");if(h.animate){var r=e(window).scrollTop()+e("#infscr-loading").height()+h.extraScrollPx+"px";e("html,body").animate({scrollTop:r},800,function(){p.isDuringAjax=false})}n.call(e(h.contentSelector)[0],t);if(!h.animate)p.isDuringAjax=false}}e.browser.ie6=e.browser.msie&&e.browser.version<7;var h=e.extend({},e.infinitescroll.defaults,t),p=e.infinitescroll,d,v;n=n||function(){};if(!i(h)){return false}p.container=h.localMode?this:document.documentElement;h.contentSelector=h.contentSelector||this;var m=/(.*?\/\/).*?(\/.*)/,g=e(h.nextSelector).attr("href");if(!g){r("Navigation selector not found");return}g=s(g);if(h.localMode)e(p.container)[0].scrollTop=0;p.pixelsFromNavToBottom=o()+(p.container==document.documentElement?0:e(p.container).offset().top)-e(h.navSelector).offset().top;p.loadingMsg=e("<div></div>");(new Image).src=h.loadingImg;e(document).ajaxError(function(t,n,i){r("Page not found. Self-destructing...");if(n.status==404){a();p.isDone=true;e(h.localMode?this:window).unbind("scroll.infscr")}});e(h.localMode?this:window).bind("scroll.infscr",f).trigger("scroll.infscr");e(document).bind("retrieve.infscr",l);return this};e.infinitescroll={defaults:{debug:false,preload:false,nextSelector:"div.navigation a:first",loadingImg:"",loadingText:"",donetext:"",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:false,localMode:false,bufferPx:40,errorCallback:function(){}},loadingImg:undefined,loadingMsg:undefined,container:undefined,currPage:1,currDOMChunk:null,isDuringAjax:false,isInvalidPage:false,isDone:false}})(jQuery)